{"ast":null,"code":"import { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/auth/firebase/auth.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = () => ({\n  standalone: true\n});\nfunction ChatComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵlistener(\"click\", function ChatComponent_div_0_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.mostrarChat = true);\n    });\n    i0.ɵɵelement(1, \"img\", 3);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChatComponent_div_1_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const mensaje_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.usuarioLogeado.uid == mensaje_r4.emisor ? \"enviado\" : \"recibido\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", mensaje_r4.texto, \" \");\n  }\n}\nfunction ChatComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5);\n    i0.ɵɵtext(2, \" CHAT ASIX \");\n    i0.ɵɵelementStart(3, \"div\", 6);\n    i0.ɵɵlistener(\"click\", function ChatComponent_div_1_Template_div_click_3_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.mostrarChat = false);\n    });\n    i0.ɵɵtext(4, \"X\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 7)(6, \"div\", 8);\n    i0.ɵɵtemplate(7, ChatComponent_div_1_p_7_Template, 2, 2, \"p\", 9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"form\", 10);\n    i0.ɵɵlistener(\"ngSubmit\", function ChatComponent_div_1_Template_form_ngSubmit_8_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.enviarMensaje);\n    });\n    i0.ɵɵelementStart(9, \"input\", 11);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ChatComponent_div_1_Template_input_ngModelChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.nuevoMensaje, $event) || (ctx_r1.nuevoMensaje = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 12);\n    i0.ɵɵlistener(\"click\", function ChatComponent_div_1_Template_div_click_10_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.enviarMensaje());\n    });\n    i0.ɵɵelementStart(11, \"span\", 13);\n    i0.ɵɵelement(12, \"img\", 14);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.mensajes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.nuevoMensaje);\n    i0.ɵɵproperty(\"ngModelOptions\", i0.ɵɵpureFunction0(3, _c0));\n  }\n}\nexport let ChatComponent = /*#__PURE__*/(() => {\n  class ChatComponent {\n    constructor(authService) {\n      this.authService = authService;\n      this.nuevoMensaje = \"\";\n      // usuarioLogeado:any;\n      this.usuarioLogeado = null; // Usa el tipo User de Firebase\n      this.mostrarChat = false;\n      // lista de mensajes\n      this.mensajes = [{\n        emisor: \"JbL4WjYkWLW8e0iwd9gh4ZCOIKR2\",\n        texto: \"hola que tal\"\n      }, {\n        emisor: \"id\",\n        texto: \"Todo bien y tu?\"\n      }, {\n        emisor: \"JbL4WjYkWLW8e0iwd9gh4ZCOIKR2\",\n        texto: \"Regular, con mucho sueño\"\n      }];\n    }\n    ngOnInit() {\n      this.authService.getUserLogged().subscribe(usuario => {\n        this.usuarioLogeado = usuario;\n      });\n    }\n    enviarMensaje() {\n      if (this.nuevoMensaje == \"\") {\n        return;\n      }\n      console.log(this.nuevoMensaje);\n      //if para comprobar que el usuario este logeado\n      if (this.usuarioLogeado) {\n        let mensaje = {\n          emisor: this.usuarioLogeado.uid,\n          texto: this.nuevoMensaje\n        };\n        //añadimos el mensaje a la lista\n        this.mensajes.push(mensaje);\n        this.nuevoMensaje = \"\";\n        setTimeout(() => {\n          this.scrollToTheLastElementByClassName();\n        }, 10);\n      } else {\n        console.error(\"Usuario no logeado\");\n      }\n    }\n    scrollToTheLastElementByClassName() {\n      //obtenemos todos los mensajes\n      let elements = document.getElementsByClassName('msj');\n      if (elements.length > 0) {\n        let ultimo = elements[elements.length - 1];\n        let toppos = ultimo.offsetTop;\n        let contenedor = document.getElementById('contenedorMensajes');\n        if (contenedor && typeof toppos === 'number') {\n          contenedor.scrollTop = toppos;\n        }\n      }\n    }\n    static #_ = this.ɵfac = function ChatComponent_Factory(t) {\n      return new (t || ChatComponent)(i0.ɵɵdirectiveInject(i1.AuthService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ChatComponent,\n      selectors: [[\"app-chat\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 2,\n      vars: 2,\n      consts: [[\"class\", \"chatIconContainer\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"card text-center cardContainer\", 4, \"ngIf\"], [1, \"chatIconContainer\", 3, \"click\"], [\"src\", \"https://cdn-icons-png.flaticon.com/512/14/14558.png\", \"alt\", \"\", 1, \"chatIcon\"], [1, \"card\", \"text-center\", \"cardContainer\"], [1, \"card-header\"], [1, \"cerrarchat\", 3, \"click\"], [1, \"card-body\"], [\"id\", \"contenedorMensajes\", 1, \"contenedorMensajes\", \"h-100\"], [\"class\", \"msj p-2\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-footer\", \"text-muted\", \"input-group\", 3, \"ngSubmit\"], [\"type\", \"text\", \"placeholder\", \"Ingrese su mensaje\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\", \"ngModelOptions\"], [1, \"input-group-append\", 3, \"click\"], [\"id\", \"basic-addon2\", 1, \"input-group-text\"], [\"src\", \"https://static-00.iconduck.com/assets.00/send-icon-2048x2048-h9h456ci.png\", \"width\", \"20px\", \"alt\", \"enviar mensaje\", 1, \"imgEnviar\"], [1, \"msj\", \"p-2\", 3, \"ngClass\"]],\n      template: function ChatComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, ChatComponent_div_0_Template, 2, 0, \"div\", 0)(1, ChatComponent_div_1_Template, 13, 4, \"div\", 1);\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"ngIf\", ctx.usuarioLogeado && !ctx.mostrarChat);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.usuarioLogeado && ctx.mostrarChat);\n        }\n      },\n      dependencies: [FormsModule, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.NgModel, i2.NgForm, CommonModule, i3.NgClass, i3.NgForOf, i3.NgIf],\n      styles: [\".cardContainer[_ngcontent-%COMP%]{width:300px;height:500px;position:fixed;right:.5rem;bottom:.5rem;background-color:#9c3737}.card-header[_ngcontent-%COMP%]{background-color:#9c3737;color:#fff;font-weight:700}.card-body[_ngcontent-%COMP%]{padding:.5rem;background-image:url(https://mrwallpaper.com/images/hd/emoticons-and-symbols-whatsapp-chat-81z2ulpylfyqalb3.jpg)}.imgEnviar[_ngcontent-%COMP%]:active{transform:scale(.9)}.enviado[_ngcontent-%COMP%]{display:block;float:right;background-color:#014621;color:#fff;min-width:50.01%;border-radius:10px}.recibido[_ngcontent-%COMP%]{display:block;float:left;background-color:#6b6b6b;color:#fff;min-width:50.01%;border-radius:10px}.contenedorMensajes[_ngcontent-%COMP%]{overflow:scroll;padding:.3rem}.contenedorMensajes[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.chatIconContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:60px;height:60px;position:fixed;right:.5rem;bottom:.5rem;cursor:pointer;background-color:gray;border-radius:100%;box-shadow:0 0 10px 2px gray}.chatIcon[_ngcontent-%COMP%]{width:40px;height:40px}.closeIcon[_ngcontent-%COMP%]{position:absolute;right:.5rem;cursor:pointer;top:0rem}\"]\n    });\n  }\n  return ChatComponent;\n})();\n;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}